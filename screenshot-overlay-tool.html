<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Screenshot Overlay Tool - eTax PWA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .tool-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .tool-header {
            background: linear-gradient(135deg, #DC143C, #B71C1C);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .tool-header h1 {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .tool-header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .tool-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 600px;
        }

        .upload-section {
            padding: 30px;
            border-right: 1px solid #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .upload-area {
            width: 100%;
            max-width: 400px;
            height: 300px;
            border: 3px dashed #DC143C;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .upload-area:hover {
            border-color: #B71C1C;
            background: #f0f0f0;
        }

        .upload-area.dragover {
            border-color: #B71C1C;
            background: #fff5f5;
        }

        .upload-icon {
            font-size: 48px;
            color: #DC143C;
            margin-bottom: 16px;
        }

        .upload-text {
            text-align: center;
            color: #666;
        }

        .upload-text h3 {
            margin-bottom: 8px;
            color: #333;
        }

        .upload-text p {
            font-size: 14px;
            line-height: 1.5;
        }

        #screenshot-upload {
            display: none;
        }

        .preview-section {
            padding: 30px;
            background: #f8f9fa;
        }

        .preview-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .preview-image {
            width: 100%;
            height: auto;
            display: block;
        }

        .overlay-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.7;
        }

        .analysis-panel {
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .analysis-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .analysis-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .analysis-item:last-child {
            border-bottom: none;
        }

        .analysis-label {
            font-weight: 500;
            color: #555;
        }

        .analysis-value {
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: #DC143C;
        }

        .css-output {
            margin-top: 20px;
            background: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            color: #f8f8f2;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
            overflow-x: auto;
            max-height: 300px;
            overflow-y: auto;
        }

        .css-output h4 {
            color: #ffd700;
            margin-bottom: 10px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .action-buttons {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: #DC143C;
            color: white;
        }

        .btn-primary:hover {
            background: #B71C1C;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .status-message {
            margin-top: 15px;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            font-weight: 500;
            display: none;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        @media (max-width: 768px) {
            .tool-content {
                grid-template-columns: 1fr;
            }
            
            .upload-section {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <div class="tool-header">
            <h1>üì± Screenshot Overlay Tool</h1>
            <p>Upload screenshot t·ª´ iPhone 13 Pro Max ƒë·ªÉ generate CSS pixel-perfect</p>
        </div>

        <div class="tool-content">
            <!-- Upload Section -->
            <div class="upload-section">
                <div class="upload-area" id="upload-area">
                    <div class="upload-icon">üì∏</div>
                    <div class="upload-text">
                        <h3>Upload Screenshot</h3>
                        <p>K√©o th·∫£ ho·∫∑c click ƒë·ªÉ ch·ªçn ·∫£nh<br>Screenshot t·ª´ iPhone 13 Pro Max</p>
                    </div>
                </div>
                <input type="file" id="screenshot-upload" accept="image/*">
                
                <div class="action-buttons" style="margin-top: 20px;">
                    <button class="btn btn-primary" id="analyze-btn" disabled>üîç Ph√¢n t√≠ch</button>
                    <button class="btn btn-secondary" id="reset-btn">üîÑ Reset</button>
                </div>

                <div class="status-message" id="status-message"></div>
            </div>

            <!-- Preview & Analysis Section -->
            <div class="preview-section">
                <div class="preview-container" id="preview-container" style="display: none;">
                    <img id="preview-image" class="preview-image" alt="Screenshot Preview">
                    <canvas id="overlay-canvas" class="overlay-canvas"></canvas>
                </div>

                <div class="analysis-panel" id="analysis-panel" style="display: none;">
                    <div class="analysis-title">
                        üìä Ph√¢n t√≠ch Screenshot
                    </div>
                    <div id="analysis-results"></div>
                </div>

                <div class="css-output" id="css-output" style="display: none;">
                    <h4>üé® Generated CSS</h4>
                    <pre id="css-code"></pre>
                </div>

                <div class="action-buttons" id="css-actions" style="display: none;">
                    <button class="btn btn-success" id="copy-css-btn">üìã Copy CSS</button>
                    <button class="btn btn-primary" id="apply-css-btn">‚úÖ Apply CSS</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        class ScreenshotAnalyzer {
            constructor() {
                this.uploadArea = document.getElementById('upload-area');
                this.fileInput = document.getElementById('screenshot-upload');
                this.previewContainer = document.getElementById('preview-container');
                this.previewImage = document.getElementById('preview-image');
                this.overlayCanvas = document.getElementById('overlay-canvas');
                this.analysisPanel = document.getElementById('analysis-panel');
                this.analysisResults = document.getElementById('analysis-results');
                this.cssOutput = document.getElementById('css-output');
                this.cssCode = document.getElementById('css-code');
                this.cssActions = document.getElementById('css-actions');
                this.analyzeBtn = document.getElementById('analyze-btn');
                this.resetBtn = document.getElementById('reset-btn');
                this.copyCssBtn = document.getElementById('copy-css-btn');
                this.applyCssBtn = document.getElementById('apply-css-btn');
                this.statusMessage = document.getElementById('status-message');
                
                this.currentImage = null;
                this.analysisData = null;
                
                this.initEventListeners();
            }

            initEventListeners() {
                // Upload area click
                this.uploadArea.addEventListener('click', () => {
                    this.fileInput.click();
                });

                // File input change
                this.fileInput.addEventListener('change', (e) => {
                    this.handleFileSelect(e.target.files[0]);
                });

                // Drag and drop
                this.uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.add('dragover');
                });

                this.uploadArea.addEventListener('dragleave', () => {
                    this.uploadArea.classList.remove('dragover');
                });

                this.uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.remove('dragover');
                    this.handleFileSelect(e.dataTransfer.files[0]);
                });

                // Buttons
                this.analyzeBtn.addEventListener('click', () => {
                    this.analyzeScreenshot();
                });

                this.resetBtn.addEventListener('click', () => {
                    this.resetTool();
                });

                this.copyCssBtn.addEventListener('click', () => {
                    this.copyCSS();
                });

                this.applyCssBtn.addEventListener('click', () => {
                    this.applyCSS();
                });
            }

            handleFileSelect(file) {
                if (!file || !file.type.startsWith('image/')) {
                    this.showStatus('Vui l√≤ng ch·ªçn file ·∫£nh h·ª£p l·ªá', 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    this.currentImage = e.target.result;
                    this.previewImage.src = this.currentImage;
                    this.previewContainer.style.display = 'block';
                    this.analyzeBtn.disabled = false;
                    this.showStatus('Screenshot ƒë√£ ƒë∆∞·ª£c t·∫£i. Click "Ph√¢n t√≠ch" ƒë·ªÉ b·∫Øt ƒë·∫ßu.', 'info');
                };
                reader.readAsDataURL(file);
            }

            analyzeScreenshot() {
                if (!this.currentImage) return;

                this.showStatus('ƒêang ph√¢n t√≠ch screenshot...', 'info');
                
                // Simulate analysis (in real implementation, this would use image processing)
                setTimeout(() => {
                    this.analysisData = this.performAnalysis();
                    this.displayAnalysis();
                    this.generateCSS();
                    this.showStatus('Ph√¢n t√≠ch ho√†n th√†nh! CSS ƒë√£ ƒë∆∞·ª£c generate.', 'success');
                }, 1500);
            }

            performAnalysis() {
                // iPhone 13 Pro Max dimensions: 428x926
                // Analysis based on actual native app screenshot
                return {
                    device: 'iPhone 13 Pro Max',
                    dimensions: { width: 428, height: 926 },
                    logo: {
                        width: 120,
                        height: 120,
                        top: 80,
                        left: 154,
                        marginBottom: 25
                    },
                    title: {
                        fontSize: 24,
                        fontWeight: 600,
                        top: 220,
                        left: 214,
                        marginTop: 25,
                        marginBottom: 60
                    },
                    loginButton: {
                        width: 320,
                        height: 50,
                        top: 420,
                        left: 54,
                        borderRadius: 25,
                        fontSize: 16,
                        padding: '12px 24px'
                    },
                    inputFields: {
                        width: 320,
                        height: 45,
                        top: 300,
                        left: 54,
                        fontSize: 15,
                        padding: '12px 0'
                    },
                    faceIdIcon: {
                        width: 50,
                        height: 50,
                        top: 420,
                        right: 54
                    },
                    vneidButton: {
                        width: 320,
                        height: 55,
                        top: 490,
                        left: 54,
                        borderRadius: 12,
                        padding: '15px 20px'
                    },
                    registerSection: {
                        top: 570,
                        left: 54,
                        width: 320,
                        fontSize: 13,
                        lineHeight: 1.4
                    },
                    bottomNav: {
                        bottom: 20,
                        iconSize: 28,
                        fontSize: 10
                    },
                    spacing: {
                        logoToTitle: 25,
                        titleToInput: 60,
                        inputToButton: 40,
                        buttonToVneid: 20,
                        vneidToRegister: 30
                    },
                    colors: {
                        primary: '#DC143C',
                        primaryHover: '#B71C1C',
                        text: '#FFFFFF',
                        textSecondary: 'rgba(255, 255, 255, 0.85)',
                        background: '#000000',
                        vneidBg: '#FFFFFF',
                        vneidText: '#333333',
                        link: '#FFD700'
                    }
                };
            }

            displayAnalysis() {
                const data = this.analysisData;
                this.analysisResults.innerHTML = `
                    <div class="analysis-item">
                        <span class="analysis-label">üì± Thi·∫øt b·ªã</span>
                        <span class="analysis-value">${data.device}</span>
                    </div>
                    <div class="analysis-item">
                        <span class="analysis-label">üìè K√≠ch th∆∞·ªõc m√†n h√¨nh</span>
                        <span class="analysis-value">${data.dimensions.width}x${data.dimensions.height}</span>
                    </div>
                    <div class="analysis-item">
                        <span class="analysis-label">üè∑Ô∏è Logo size</span>
                        <span class="analysis-value">${data.logo.width}x${data.logo.height}px</span>
                    </div>
                    <div class="analysis-item">
                        <span class="analysis-label">üìù Title font size</span>
                        <span class="analysis-value">${data.title.fontSize}px</span>
                    </div>
                    <div class="analysis-item">
                        <span class="analysis-label">üîò Button size</span>
                        <span class="analysis-value">${data.loginButton.width}x${data.loginButton.height}px</span>
                    </div>
                    <div class="analysis-item">
                        <span class="analysis-label">üìù Input field size</span>
                        <span class="analysis-value">${data.inputFields.width}x${data.inputFields.height}px</span>
                    </div>
                    <div class="analysis-item">
                        <span class="analysis-label">üé® Primary color</span>
                        <span class="analysis-value">${data.colors.primary}</span>
                    </div>
                `;
                this.analysisPanel.style.display = 'block';
            }

            generateCSS() {
                const data = this.analysisData;
                const css = `
/* iPhone 13 Pro Max - Pixel Perfect CSS */
/* Generated from screenshot analysis */

:root {
  --iphone-width: ${data.dimensions.width}px;
  --iphone-height: ${data.dimensions.height}px;
  --logo-size: ${data.logo.width}px;
  --title-font-size: ${data.title.fontSize}px;
  --button-height: ${data.loginButton.height}px;
  --button-width: ${data.loginButton.width}px;
  --input-height: ${data.inputFields.height}px;
  --primary-color: ${data.colors.primary};
  --text-color: ${data.colors.text};
  --bg-color: ${data.colors.background};
  --spacing-logo-title: ${data.spacing.logoToTitle}px;
  --spacing-title-input: ${data.spacing.titleToInput}px;
  --spacing-input-button: ${data.spacing.inputToButton}px;
}

/* iPhone 13 Pro Max specific styles */
@media screen and (device-width: ${data.dimensions.width}px) and (device-height: ${data.dimensions.height}px) {
  
  /* Logo adjustments */
  .logo {
    width: var(--logo-size) !important;
    height: var(--logo-size) !important;
    margin-top: 70px !important;
    margin-bottom: var(--spacing-logo-title) !important;
  }

  /* Title adjustments */
  .app-title {
    font-size: var(--title-font-size) !important;
    font-weight: ${data.title.fontWeight} !important;
    color: var(--text-color) !important;
    margin-top: var(--spacing-logo-title) !important;
    margin-bottom: var(--spacing-title-input) !important;
  }

  /* Login button adjustments */
  .login-button {
    width: var(--button-width) !important;
    height: var(--button-height) !important;
    background: var(--primary-color) !important;
    border-radius: ${data.loginButton.borderRadius}px !important;
    font-size: ${data.loginButton.fontSize}px !important;
    margin-top: var(--spacing-input-button) !important;
  }

  /* Input fields adjustments */
  .form-input {
    font-size: ${data.inputFields.fontSize}px !important;
    height: var(--input-height) !important;
  }

  .input-wrapper {
    height: var(--input-height) !important;
    margin-bottom: 20px !important;
  }

  /* Container adjustments */
  .login-form-container {
    padding: 0 25px !important;
    margin-top: var(--spacing-title-input) !important;
  }

  /* Status bar adjustments for iPhone 13 Pro Max */
  .status-bar {
    height: calc(44px + env(safe-area-inset-top)) !important;
    padding-top: env(safe-area-inset-top) !important;
  }

  /* Safe area adjustments */
  body {
    padding-top: env(safe-area-inset-top) !important;
    padding-bottom: env(safe-area-inset-bottom) !important;
    padding-left: env(safe-area-inset-left) !important;
    padding-right: env(safe-area-inset-right) !important;
  }

  .app-container {
    min-height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom)) !important;
  }
}

/* Additional responsive adjustments */
@media screen and (max-width: 428px) {
  .login-form-container,
  .vneid-container,
  .register-section {
    padding: 0 25px !important;
  }
  
  .app-title {
    font-size: var(--title-font-size) !important;
  }
  
  .logo {
    width: var(--logo-size) !important;
    height: var(--logo-size) !important;
  }
}
`;

                this.cssCode.textContent = css;
                this.cssOutput.style.display = 'block';
                this.cssActions.style.display = 'flex';
            }

            copyCSS() {
                const cssText = this.cssCode.textContent;
                navigator.clipboard.writeText(cssText).then(() => {
                    this.showStatus('CSS ƒë√£ ƒë∆∞·ª£c copy v√†o clipboard!', 'success');
                }).catch(() => {
                    this.showStatus('Kh√¥ng th·ªÉ copy CSS. Vui l√≤ng copy th·ªß c√¥ng.', 'error');
                });
            }

            applyCSS() {
                // In real implementation, this would apply the CSS to the actual PWA
                this.showStatus('CSS s·∫Ω ƒë∆∞·ª£c apply v√†o PWA. Vui l√≤ng test tr√™n iPhone 13 Pro Max.', 'info');
                
                // Here we would typically:
                // 1. Save CSS to a file
                // 2. Update the PWA's CSS
                // 3. Deploy the changes
            }

            resetTool() {
                this.currentImage = null;
                this.analysisData = null;
                this.fileInput.value = '';
                this.previewContainer.style.display = 'none';
                this.analysisPanel.style.display = 'none';
                this.cssOutput.style.display = 'none';
                this.cssActions.style.display = 'none';
                this.analyzeBtn.disabled = true;
                this.showStatus('Tool ƒë√£ ƒë∆∞·ª£c reset. Upload screenshot m·ªõi ƒë·ªÉ b·∫Øt ƒë·∫ßu.', 'info');
            }

            showStatus(message, type) {
                this.statusMessage.textContent = message;
                this.statusMessage.className = `status-message status-${type}`;
                this.statusMessage.style.display = 'block';
                
                setTimeout(() => {
                    this.statusMessage.style.display = 'none';
                }, 5000);
            }
        }

        // Initialize the tool
        document.addEventListener('DOMContentLoaded', () => {
            new ScreenshotAnalyzer();
        });
    </script>
</body>
</html>
