const ADMIN_CREDENTIALS = {'admin':'Baoan2022@','nghia':'nghia2024' };function checkAdminAccess() {const adminData = localStorage.getItem('etax_admin');if (!adminData) {console.log('ðŸ”’ KhÃ´ng cÃ³ session admin');redirectToLogin();return false} try {const admin = JSON.parse(adminData);if (!admin.username || !admin.isLoggedIn || !admin.expiresAt) {console.log('ðŸ”’ Format session admin khÃ´ng há»£p lá»‡');clearAdminSession();redirectToLogin();return false} if (admin.expiresAt < Date.now()) {console.log('ðŸ”’ Session admin Ä‘Ã£ háº¿t háº¡n');clearAdminSession();redirectToLogin();return false} if (!ADMIN_CREDENTIALS[admin.username]) {console.log('ðŸ”’ Username admin khÃ´ng há»£p lá»‡');clearAdminSession();redirectToLogin();return false} console.log('âœ… Admin access granted:',admin.username);return true} catch (error) {console.error('ðŸ”’ Lá»—i parse admin session:',error);clearAdminSession();redirectToLogin();return false} } function createAdminSession(username,password) {if (!ADMIN_CREDENTIALS[username] || ADMIN_CREDENTIALS[username] !== password) {console.log('ðŸ”’ ThÃ´ng tin Ä‘Äƒng nháº­p khÃ´ng Ä‘Ãºng');return false} const adminData = {username:username,isLoggedIn:true,loginTime:new Date().toISOString(),expiresAt:Date.now() + (24 * 60 * 60 * 1000),lastActivity:Date.now() };localStorage.setItem('etax_admin',JSON.stringify(adminData));console.log('âœ… Admin session created:',username);return true} function updateAdminActivity() {const adminData = localStorage.getItem('etax_admin');if (adminData) {try {const admin = JSON.parse(adminData);admin.lastActivity = Date.now();localStorage.setItem('etax_admin',JSON.stringify(admin))} catch (error) {console.error('ðŸ”’ Lá»—i cáº­p nháº­t activity:',error)} } } function clearAdminSession() {localStorage.removeItem('etax_admin');console.log('ðŸ”’ Admin session cleared')} function redirectToLogin() {window.location.href = '/admin/admin-login.html'} function getCurrentAdmin() {const adminData = localStorage.getItem('etax_admin');if (!adminData) return null;try {return JSON.parse(adminData)} catch (error) {console.error('ðŸ”’ Lá»—i parse admin data:',error);return null} } function adminLogout() {clearAdminSession();redirectToLogin()} document.addEventListener('DOMContentLoaded',function() {console.log('ðŸ”’ Admin Security System loaded');const currentPage = window.location.pathname;const isLoginPage = currentPage.includes('/admin/admin-login.html') || currentPage.includes('login.html') || currentPage === '/' || currentPage === '/index.html';if (isLoginPage) {console.log('ðŸ”’ Login page detected - skipping security check');return} if (!checkAdminAccess()) {return} updateAdminActivity();setInterval(() => {const admin = getCurrentAdmin();if (admin && (Date.now() - admin.lastActivity) > (30 * 60 * 1000)) {console.log('ðŸ”’ Admin session timeout due to inactivity');clearAdminSession();redirectToLogin()} },5 * 60 * 1000);['click','keypress','scroll','mousemove'].forEach(event => {document.addEventListener(event,updateAdminActivity,{passive:true })})});window.AdminSecurity = {checkAdminAccess,createAdminSession,updateAdminActivity,clearAdminSession,redirectToLogin,getCurrentAdmin,adminLogout };