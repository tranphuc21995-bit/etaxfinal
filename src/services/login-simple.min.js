document.addEventListener('DOMContentLoaded',function () {console.log('=== SIMPLE LOGIN PAGE LOADED ===');setupLoginForm()});function setupLoginForm() {const loginForm = document.getElementById('loginForm');const loginBtn = document.getElementById('loginBtn');const errorMsg = document.getElementById('errorMsg');if (loginForm) {loginForm.addEventListener('submit',handleLogin)} if (loginBtn) {loginBtn.addEventListener('click',handleLogin)} } function handleLogin(event) {event.preventDefault();const username = document.getElementById('tax-id').value.trim();const password = document.getElementById('password').value.trim();const errorMsg = document.getElementById('errorMsg');const loginBtn = document.getElementById('loginBtn');if (errorMsg) {errorMsg.textContent = '';errorMsg.style.display = 'none'} if (!username || !password) {showError('Vui lòng nhập đầy đủ tên đăng nhập và mật khẩu');return} if (loginBtn) {loginBtn.textContent = 'Đang đăng nhập...';loginBtn.disabled = true} setTimeout(() => {const result = window.auth.validateLogin(username,password);if (result.success) {window.auth.setLoggedIn(true);window.auth.setUserInfo(result.user);showSuccess('Đăng nhập thành công! Đang chuyển hướng...');setTimeout(() => {window.location.href = 'index.html'},1500)} else {showError(result.message);if (loginBtn) {loginBtn.textContent = 'Đăng nhập';loginBtn.disabled = false} } },1000)} function showError(message) {const errorMsg = document.getElementById('errorMsg');if (errorMsg) {errorMsg.textContent = message;errorMsg.style.display = 'block';errorMsg.style.color = '#e74c3c';errorMsg.style.backgroundColor = '#fdf2f2';errorMsg.style.border = '1px solid #fecaca'} } function showSuccess(message) {const errorMsg = document.getElementById('errorMsg');if (errorMsg) {errorMsg.textContent = message;errorMsg.style.display = 'block';errorMsg.style.color = '#27ae60';errorMsg.style.backgroundColor = '#f0f9ff';errorMsg.style.border = '1px solid #86efac'} } function togglePassword() {const passwordInput = document.getElementById('password');const toggleIcon = document.getElementById('togglePassword');if (passwordInput && toggleIcon) {if (passwordInput.type === 'password') {passwordInput.type = 'text';toggleIcon.classList.remove('fa-eye');toggleIcon.classList.add('fa-eye-slash')} else {passwordInput.type = 'password';toggleIcon.classList.remove('fa-eye-slash');toggleIcon.classList.add('fa-eye')} } } function shareApp() {if (navigator.share) {navigator.share({title:'eTax Mobile',text:'Ứng dụng khai thuế điện tử',url:window.location.href }).catch(console.error)} else {if (navigator.clipboard) {navigator.clipboard.writeText(window.location.href);alert('Đã sao chép link vào clipboard!')} else {alert('Link:' + window.location.href)} } } if ('serviceWorker' in navigator) {window.addEventListener('load',function () {navigator.serviceWorker.register('/service-worker.js') .then(function (registration) {console.log('ServiceWorker registration successful')}) .catch(function (err) {console.log('ServiceWorker registration failed')})})}